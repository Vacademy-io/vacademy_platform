spring.application.name=admin_core_service
## Database Connection
spring.datasource.url=${ADMIN_CORE_SERVICE_DB_URL}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.username=${DB_USERNAME}
## Security
application.my.username=${APP_USERNAME}
application.my.password=${APP_PASSWORD}
spring.mvc.dispatch-options-request=true
## auth.server.baseurl=http://localhost:8071
auth.server.baseurl=${AUTH_SERVER_BASE_URL}
notification.server.baseurl=${NOTIFICATION_SERVER_BASE_URL}
media.server.baseurl=${MEDIA_SERVER_BASE_URL}
assessment.server.baseurl=${ASSESSMENT_SERVER_BASE_URL}
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
logging.level.org.springframework.security=DEBUG
cloud.front.url=${CLOUD_FRONT_URL}
## Logging
org.springframework.boot.actuate.health.Logger=OFF
logging.level.org.springframework.boot.actuate.health=OFF
#spring.jpa.show-sql=true
#spring.jpa.properties.hibernate.format_sql=true
logging.level.org.springframework.web=DEBUG
logging.level.org.hibernate=ERROR


# This tells Flyway to accept an existing schema and create a baseline
spring.flyway.baseline-on-migrate=true

# This tells Flyway which version number to baseline to.
# It should match your first migration script (e.g., V1__Initial_schema.sql)
spring.flyway.baseline-version=1

# Allow out-of-order migrations and ignore missing ones
spring.flyway.out-of-order=true
spring.flyway.ignore-missing-migrations=true
spring.flyway.ignore-ignored-migrations=true
spring.flyway.validate-on-migrate=false
default.learner.portal.url=https://learner.vacademy.io

# ============ JPA/Hibernate Performance Optimization ============
# Use READ_COMMITTED isolation (fastest for OLTP)
spring.jpa.properties.hibernate.connection.isolation=2

# Batch operations (critical for bulk inserts/updates)
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.batch_versioned_data=true

# Fetch size (reduces round trips for large result sets)
spring.jpa.properties.hibernate.jdbc.fetch_size=100

# Statement caching (reuse prepared statements)
spring.jpa.properties.hibernate.jdbc.use_get_generated_keys=true
spring.jpa.properties.hibernate.cache.use_query_cache=false
spring.jpa.properties.hibernate.generate_statistics=false

# Query optimization
spring.jpa.properties.hibernate.query.in_clause_parameter_padding=true
# Set to false to avoid runtime exceptions; monitor logs for pagination warnings instead
spring.jpa.properties.hibernate.query.fail_on_pagination_over_collection_fetch=false

# Connection release mode (release after transaction for pooling efficiency)
spring.jpa.properties.hibernate.connection.handling_mode=DELAYED_ACQUISITION_AND_RELEASE_AFTER_TRANSACTION

# ============ PostgreSQL-specific JDBC Optimizations ============
# Add to JDBC URL for better performance
# ?reWriteBatchedInserts=true&prepareThreshold=5&ApplicationName=admin_core_service

openrouter.api.key=${OPENROUTER_API_KEY}

# Embedding Service Configuration
embedding.storage.path=${EMBEDDING_STORAGE_PATH:./embeddings}
api.docs.path=${API_DOCS_PATH:admin_core_service/admin_apis.md}

# Agent Configuration
tool.executor.base-url=${ADMIN_CORE_SERVICE_BASE_URL:http://localhost}
