spring.application.name=auth_service
server.port=8071
management.endpoints.web.base-path=/auth-service
management.endpoints.web.path-mapping.health=actuator/health
springdoc.api-docs.path=/auth_service/api-docs
springdoc.swagger-ui.path=/auth_service/swagger-ui.html
spring.profiles.active=${environment}
springdoc.api-docs.path=/auth-service/api-docs
springdoc.swagger-ui.path=/auth-service/swagger-ui.html
spring.profiles.active=${environment}

# ============ HikariCP Connection Pool Configuration ============
# These settings are CRITICAL for preventing inconsistent API latency

# Maximum number of connections in the pool
# Auth service typically has lighter load, 15 should be enough
spring.datasource.hikari.maximum-pool-size=15

# Minimum number of idle connections to maintain
spring.datasource.hikari.minimum-idle=5

# How long (ms) to wait for a connection from the pool
# 60 seconds is reasonable - fail fast rather than hang
spring.datasource.hikari.connection-timeout=60000

# How long a connection can be idle before being retired
spring.datasource.hikari.idle-timeout=300000

# Maximum lifetime of a connection (should be less than DB's wait_timeout)
spring.datasource.hikari.max-lifetime=600000

# Connection validation timeout
spring.datasource.hikari.validation-timeout=5000

# Keep connections alive (useful for firewalls/proxies that kill idle connections)
spring.datasource.hikari.keepalive-time=60000

# Log pool usage warnings
spring.datasource.hikari.leak-detection-threshold=60000

# Sentry Configuration
sentry.dsn=${SENTRY_DSN}
sentry.send-default-pii=true

# Performance Monitoring - 100% of transactions (reduce in production for cost optimization)
sentry.traces-sample-rate=1.0
# Enable performance monitoring for all integrations
sentry.enable-tracing=true
# Database query monitoring
sentry.trace-propagation-targets=localhost,127.0.0.1
# Additional performance settings
sentry.in-app-includes=vacademy.io

# ============ TRUSTED LOGIN (EMERGENCY) ============
# ⚠️ TEMPORARY: Enable only when SES email service is down
# TODO: Remove this configuration once email service is restored
# Security: Set to false (default) in production unless emergency
security.trusted-login.enabled=true
