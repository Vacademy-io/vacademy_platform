spring.application.name=notification_service
## Database Connection
spring.datasource.url=${NOTIFICATION_SERVICE_DB_URL}
spring.datasource.read.url=${NOTIFICATION_SERVICE_READ_DB_URL:${NOTIFICATION_SERVICE_DB_URL}}
spring.datasource.hikari.maximum-pool-size=3
spring.datasource.hikari.minimum-idle=1
spring.datasource.password=${DB_PASSWORD}
spring.datasource.username=${DB_USERNAME}
## Email Credentials
spring.mail.host=${MAIL_HOST}
spring.mail.port=${MAIL_PORT}
spring.mail.username=${AWS_MAIL_USERNAME}
spring.mail.password=${AWS_MAIL_PASSWORD}
## Security
application.my.username=${APP_USERNAME}
application.my.password=${APP_PASSWORD}
spring.mvc.dispatch-options-request=true
auth.server.baseurl=${AUTH_SERVER_BASE_URL}
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
logging.level.org.springframework.security=DEBUG
cloud.front.url=${CLOUD_FRONT_URL}
## Logging
org.springframework.boot.actuate.health.Logger=OFF
logging.level.org.springframework.boot.actuate.health=OFF
## Email Sender domain
app.ses.sender.email=${SES_SENDER_EMAIL}

# Email tracking and AWS placeholders (fill real values later)
ses.configuration.set=${SES_CONFIGURATION_SET}
ses.events.sqs.url=${SES_EVENTS_SQS_URL}
aws.accessKey=${SQS_AWS_ACCESS_KEY}
aws.secretKey=${SQS_AWS_SECRET_KEY}
aws.region=${SQS_AWS_REGION}

# Spring Cloud AWS Configuration 
spring.cloud.aws.region.static=${AWS_REGION}
spring.cloud.aws.credentials.access-key=${aws.accessKey}
spring.cloud.aws.credentials.secret-key=${aws.secretKey}

# SQS Configuration for Spring Cloud AWS
spring.cloud.aws.sqs.endpoint=${SQS_ENDPOINT}
spring.cloud.aws.sqs.region=${SQS_REGION}

# Enable/Disable AWS SQS - Set to false to disable SQS listeners
aws.sqs.enabled=${AWS_SQS_ENABLED:true}

## Holistic Whatsapp token
whatsapp.access-token=${WHATSAPP_ACCESS_TOKEN}
whatsapp.access-token.vidyayatan=${WHATSAPP_ACCESS_TOKEN_VIDYAYATAN}
whatsapp.phone-number-id.vidyayatan=${WHATSAPP_PHONE_NUMBER_ID_VIDYAYATAN}

## Service URLs for User Resolution
admin.core.service.baseurl=${ADMIN_CORE_SERVICE_BASE_URL}

## Notification Configuration
notification.user.batch.size=100

## Logging Configuration - Suppress Excessive Logs
## Disable Jakarta Mail DEBUG logs to prevent log flooding (50+ emails/second = 100+ SMTP protocol log lines/second)
## Note: mail.debug=false is already set in EmailConfig.java, but these logging levels provide additional suppression
logging.level.com.sun.mail=WARN
logging.level.jakarta.mail=WARN
logging.level.org.eclipse.angus=WARN
# email.rate.limit.per.second default is 50 (configured in EmailDispatcher.java - can override here if needed) 

## SSE (Server-Sent Events) Configuration
sse.timeout=300000
sse.heartbeat.interval=30000
sse.cleanup.interval=60000
sse.max.connections.per.user=5
sse.event.queue.size=1000

## Async Support for SSE
spring.mvc.async.request-timeout=300000


spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true



# This tells Flyway to accept an existing schema and create a baseline
spring.flyway.baseline-on-migrate=true

# This tells Flyway which version number to baseline to.
# It should match your first migration script (e.g., V1__Initial_schema.sql)
spring.flyway.baseline-version=1
spring.flyway.out-of-order=true
spring.flyway.ignore-missing-migrations=true
spring.flyway.ignore-ignored-migrations=true
spring.flyway.validate-on-migrate=false

# ============ JPA/Hibernate Performance Optimization ============
# Use READ_COMMITTED isolation (fastest for OLTP)
spring.jpa.properties.hibernate.connection.isolation=2

# Batch operations (critical for bulk inserts/updates)
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.batch_versioned_data=true

# Fetch size (reduces round trips for large result sets)
spring.jpa.properties.hibernate.jdbc.fetch_size=100

# Statement caching (reuse prepared statements)
spring.jpa.properties.hibernate.jdbc.use_get_generated_keys=true
spring.jpa.properties.hibernate.cache.use_query_cache=false
spring.jpa.properties.hibernate.generate_statistics=false

# Query optimization
spring.jpa.properties.hibernate.query.in_clause_parameter_padding=true
# Set to false to avoid runtime exceptions; monitor logs for pagination warnings instead
spring.jpa.properties.hibernate.query.fail_on_pagination_over_collection_fetch=false

# Connection release mode (release after transaction for pooling efficiency)
spring.jpa.properties.hibernate.connection.handling_mode=DELAYED_ACQUISITION_AND_RELEASE_AFTER_TRANSACTION
